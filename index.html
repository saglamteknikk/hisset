<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>NatureSync | Control Center</title>
    <style>
        body { 
            margin: 0; padding: 0;
            background: #000;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            color: #d8f3dc;
        }

        .forest-layer {
            position: absolute;
            width: 150%; height: 150%;
            z-index: -1;
            background: radial-gradient(circle at center, 
                rgba(64, 145, 108, 0.6) 0%, 
                rgba(27, 67, 50, 0.4) 30%, 
                rgba(8, 28, 21, 0.8) 60%, 
                rgba(0, 0, 0, 1) 90%);
            animation: intenseBreathe 8s ease-in-out infinite;
        }

        @keyframes intenseBreathe {
            0%, 100% { transform: scale(0.9); opacity: 0.4; filter: blur(30px) brightness(0.8); }
            50% { transform: scale(1.3); opacity: 1; filter: blur(15px) brightness(1.3); }
        }

        .card {
            background: rgba(10, 15, 12, 0.9);
            backdrop-filter: blur(30px);
            padding: 40px;
            border-radius: 40px;
            border: 2px solid rgba(116, 198, 157, 0.3);
            text-align: center;
            width: 420px;
            z-index: 10;
            box-shadow: 0 0 50px rgba(64, 145, 108, 0.3);
        }

        /* Dƒ∞NAMƒ∞K √ú√áL√ú Dƒ∞L SLOGANI */
        .slogan-box { margin-bottom: 30px; height: 60px; position: relative; cursor: pointer; overflow: hidden; }
        .slogan-box p { position: absolute; width: 100%; margin: 0; transition: 0.5s ease-in-out; }
        
        .slogan-tr { color: #74c69d; font-size: 1.5em; font-weight: bold; top: 15px; }
        .slogan-en { color: #95d5b2; font-size: 1.2em; top: 70px; font-style: italic; }
        .slogan-de { color: #52b788; font-size: 1.2em; top: 70px; font-style: italic; }

        /* Hover Animasyonu: TR gider, EN ve DE sƒ±rayla gelir */
        .slogan-box:hover .slogan-tr { top: -50px; opacity: 0; }
        .slogan-box:hover .slogan-en { animation: slideCycleEN 4s infinite; }
        .slogan-box:hover .slogan-de { animation: slideCycleDE 4s infinite; }

        @keyframes slideCycleEN {
            0%, 45% { top: 15px; opacity: 1; }
            50%, 100% { top: -50px; opacity: 0; }
        }
        @keyframes slideCycleDE {
            0%, 45% { top: 70px; opacity: 0; }
            50%, 95% { top: 15px; opacity: 1; }
            100% { top: -50px; opacity: 0; }
        }

        .lcd-screen {
            background: #081c15;
            color: #95d5b2;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            border: 2px solid #409167;
            width: 90%;
            height: 45px;
            outline: none;
            padding: 10px;
            border-radius: 12px;
            margin: 20px auto;
            display: block;
            text-align: center;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            text-transform: uppercase;
        }

        /* BUTONLARDA Dƒ∞L D√ñNG√úS√ú */
        .btn {
            width: 100%; height: 60px; border-radius: 16px; border: none; font-weight: bold; cursor: pointer;
            transition: 0.4s; margin: 12px 0; color: white; position: relative; overflow: hidden;
        }
        .btn span { position: absolute; width: 100%; left: 0; transition: 0.5s; }
        
        .tr-txt { top: 20px; }
        .en-txt, .de-txt { top: 70px; opacity: 0; }

        .btn:hover .tr-txt { top: -50px; opacity: 0; }
        .btn:hover .en-txt { animation: slideCycleEN 4s infinite; }
        .btn:hover .de-txt { animation: slideCycleDE 4s infinite; }

        .btn-conn { background: #081c15; color: #74c69d; border: 1px solid #1b4332; }
        .btn-msg { background: #40916c; }
        .btn:hover { transform: translateY(-3px); filter: brightness(1.2); }
        
        #status { margin-top: 20px; font-size: 0.8em; color: #74c69d; }
    </style>
</head>
<body>
    <div class="forest-layer"></div>
    <div class="card">
        <div class="slogan-box">
            <p class="slogan-tr">Senin D√ºnyan, Senin Hayatƒ±n</p>
            <p class="slogan-en">Your World, Your Life</p>
            <p class="slogan-de">Deine Welt, Dein Leben</p>
        </div>
        
        <input type="text" id="mInput" class="lcd-screen" placeholder="MAX 60 CHARS..." maxlength="60" oninput="checkOLED(this)">
        
        <button class="btn btn-conn" onclick="baglan()">
            <span class="tr-txt">Sƒ∞STEMƒ∞ UYANDIR</span>
            <span class="en-txt">WAKE SYSTEM</span>
            <span class="de-txt">SYSTEM AUFWACHEN</span>
        </button>

        <button class="btn btn-msg" onclick="gonder()">
            <span class="tr-txt">Sƒ∞STEMƒ∞ G√úNCELLE</span>
            <span class="en-txt">UPDATE SYSTEM</span>
            <span class="de-txt">SYSTEM AKTUALISIEREN</span>
        </button>
        
        <p id="status">Standby... | Beklemede... üçÉ</p>
    </div>

    <script>
        let port, writer;

        function checkLCD(el) {
            // T√ºrk√ße karakterleri temizle
            const trMap = {'√ß':'c','√á':'C','ƒü':'g','ƒû':'G','ƒ±':'i','ƒ∞':'I','√∂':'o','√ñ':'O','≈ü':'s','≈û':'S','√º':'u','√ú':'U'};
            el.value = el.value.replace(/[√ß√áƒüƒûƒ±ƒ∞√∂√ñ≈ü≈û√º√ú]/g, m => trMap[m]).toUpperCase();
            el.value = el.value.replace(/[^A-Z0-9\s]/g, '');

            let lines = el.value.split('\n');
            
            // ƒ∞lk satƒ±r 16 karakteri ge√ßerse otomatik alt satƒ±ra at
            if (lines[0].length > 16) {
                el.value = lines[0].substring(0, 16) + '\n' + lines[0].substring(16) + (lines[1] ? lines[1] : "");
            }
            
            // Toplam 2 satƒ±r ve her satƒ±r max 16 karakter sƒ±nƒ±rƒ±
            let finalLines = el.value.split('\n');
            if (finalLines.length > 2) {
                el.value = finalLines[0].substring(0, 16) + '\n' + finalLines[1].substring(0, 16);
            }
            if (finalLines[1] && finalLines[1].length > 16) {
                el.value = finalLines[0] + '\n' + finalLines[1].substring(0, 16);
            }
        }

        async function baglan() {
            try {
                port = await navigator.serial.requestPort();
                await port.open({ baudRate: 9600 });
                const encoder = new TextEncoderStream();
                encoder.readable.pipeTo(port.writable);
                writer = encoder.writable.getWriter();
                document.getElementById("status").innerText = "Sƒ∞STEM UYANDI! | SYSTEM AWAKE! üçÉ";
            } catch (e) { alert("Baƒülantƒ± hatasƒ±!"); }
        }

        async function gonder(tip) {
            if (!writer) return alert("√ñnce baƒülanƒ±n!");
            
            // Textarea'daki alt satƒ±ra ge√ßi≈üleri (enter) kayan yazƒ±da d√ºzg√ºn durmasƒ± i√ßin bo≈üluƒüa √ßeviriyoruz
            let msg = document.getElementById("mInput").value.replace(/\n/g, ' ');
            if (msg === "") msg = "SENIN DUNYAN SENIN HAYATIN";

            const n = new Date();
            const p = (v) => String(v).padStart(2, '0');
            
            const sa = p(n.getHours());
            const dk = p(n.getMinutes());
            const gun = p(n.getDate());
            const ay = p(n.getMonth() + 1);
            const yil = n.getFullYear();
            const gunIdx = n.getDay(); // 0: Pazar, 1: Pazartesi ...

            // Arduino'nun istediƒüi Gƒ∞ZLƒ∞ TEK SATIR FORMATI: M:Mesaj|S:12:30|T:25.02.2026.3
            const data = "M:" + msg + "|S:" + sa + ":" + dk + "|T:" + gun + "." + ay + "." + yil + "." + gunIdx + "\n";

            try {
                await writer.write(data);
                document.getElementById("status").innerText = "SAAT VE MESAJ G√úNCELLENDƒ∞! ‚úÖ";
            } catch(e) {
                alert("Veri g√∂nderilemedi!");
            }
        }
    </script>
</body>
</html>
